
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-19801227-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Reaction Rules &mdash; RuleBender</title>
    <link rel="stylesheet" href="../../_static/css/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootswatch-united.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/rbdocs.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/js/jquery-2.0.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/js/zeroclipboard.min.js"></script>
    <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/js/rbdocs.js"></script>
    <link rel="shortcut icon" href="../../_static/bionetgen.ico"/>

  </head>
  <body data-spy="scroll" data-target="#localtoc" data-offset="190">

<div class="container">
  <div class="row">
    <div class="span12">
      <a href="../../index.html">
        <img src="../../_static/bionetgen_logo.png" alt="BNG logo" id="logo" />
      </a>
    </div>
    <div class="span12">
      <div class="subnav">
        <ul class="nav nav-pills">
        <li class="pull-right">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a>
          </li>
        <li class="pull-right">
          <a href="actions.html" title="Actions"
             accesskey="N">next</a>
          </li>
        <li class="pull-right">
          <a href="observables.html" title="Observables"
             accesskey="P">previous</a>
          </li>
        <li><a href="../../index.html">Home  &raquo;</a></li>
          <li><a href="index.html" accesskey="U">BioNetGen Online Manual &raquo;</a></li> 
        </ul>
      </div>
    </div>
  </div>

  <div class="content">
  <div class="row">
    <div class="span3">
      <div id="sidebar" style="width: 220px">
  <div id="localtoc" style="margin-bottom: 20px">
    <ul>
<li><a class="reference internal" href="#">Reaction Rules</a><ul>
<li><a class="reference internal" href="#other-rate-laws">Other rate laws</a></li>
</ul>
</li>
</ul>

  </div>
        <div class="accordion" id="accordion2">
  <div id="searchbox" class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseToolbox">
        <strong>Toolbox</strong>
      </a>
    </div>
    <div id="collapseToolbox" class="accordion-body collapse in">
      <div class="accordion-inner">
        <div id="showcodebuttons" style="margin-bottom: 10px">
          <p><small>Show code snippets for copying:</small></p>
          <div class="btn-group">
            <a href="#codemodal" role="button" data-toggle="modal" id="showcode" class="btn btn-primary btn-small">
              <i class="icon-fullscreen icon-white"></i> Show code</a>
            <a href="#codemodal" role="button" data-toggle="modal" id="withcomments" class="btn btn-primary btn-small">
              and output <i class="icon-comment icon-white"></i> </a>
          </div>
        </div>

        <p><small>Search terms or function by name:</small></p>
        <form class="form-search pull-right" action="../../search.html" method="get">
          <div class="input-append">
            <input type="text" class="input-small search-query" name="q" class="span2">
            <button type="submit" class="btn btn-primary">Go</button>
          </div>
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
      </div>
    </div>
  </div>  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseReleaseNotes">
        <strong>Release Notes</strong>
      </a>
    </div>
    <div id="collapseReleaseNotes" class="accordion-body collapse in">
      <div class="accordion-inner">
        <p><small><strong>v1</strong> series come with new and improved sequence, structure, and dynamics analysis
features. See <a href="../../manual/release/index.html">release notes</a> for details.
        </small></p>
      </div>
    </div>
  </div>  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseHowToCite">
        <strong>How to Cite</strong>
      </a>
    </div>
    <div id="collapseHowToCite" class="accordion-body collapse in">
      <div class="accordion-inner">
                      <p>
                <small>
                  <strong>BioNetGen</strong> <br>
                  J. R. Faeder, M. L. Blinov, and W. S. Hlavacek (2009) <a href="http://www.ncbi.nlm.nih.gov/pubmed/19399430/">Rule-based modeling of biochemical systems with BioNetGen</a>, <i>Methods Mol. Biol.</i>, <strong>500</strong>, 113-67. <br> 
                 </small>
              </p>  
              <p>
                <small>
                 <strong>RuleBender</strong> <br>
                  A. M. Smith, W. Xu, Y. Sun, J. R. Faeder and G. E. Marai (2012) <a href="http://bmcbioinformatics.biomedcentral.com:80/articles/10.1186/1471-2105-13-S8-S3">RuleBender: integrated modeling, simulation and visualization for rule-based intracellular biochemistry</a>, <i>BMC Bioinformatics</i>, <strong>13</strong>(suppl. 8), S3 (16 pages). <br>
                </small>
              </p>  
              <p>
                <small>
                  <strong>NFsim</strong> <br>
                  M. W. Sneddon, J. R. Faeder and T. Emonet (2012) <a href="https://www.ncbi.nlm.nih.gov/pubmed/21186362">Efficient modeling, simulation and coarse-graining of biological complexity with NFsim.</a>, <i>Nat. Methods</i>, <strong>8</strong>, 177-183. 
                </small>
              </p>
      </div>
    </div>
  </div>
        </div>
      </div>
    </div>
    <div class="span9 body">
    
  <div class="section" id="reaction-rules">
<h1>Reaction Rules<a class="headerlink" href="#reaction-rules" title="Permalink to this headline">¶</a></h1>
<p>Reaction rules are the generators of species and reactions in a BioNetGen
model.  Each rule has four basic elements: reactant patterns, an arrow,
product patterns, and a rate law.  Reactant patterns are used to select a set
of reactant species to which the rule will be applied.  The arrow indicates
whether the rule is applied in the forward direction only or in the forward
and reverse directions.  The product patterns define how the selected species
are transformed by the rule and also act as the species selectors when the
rule is applied in reverse (if applicable).  Rules may add or delete
molecules and edges and may change component state labels.  Components may not
be added or deleted.  The default rate law is the elementary rate law, which
gives the rate of a reaction as the product of a constant factor (the rate
constant) and the reactant concentrations.  Limited support for more complex
rate laws, such as Michaelis-Menton, is also provided.</p>
<p>Let us consider a simple example of a reaction rule for the reversible binding
of ligand to receptor.  Using the molecules we defined above, we can write</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>begin reaction rules
        L(r) + R(l,d) &lt;-&gt; L(r!1).R(l!1,d) kp1, km1
end reaction rules
</pre></div>
</div>
<p>The reactant pattern <code class="docutils literal"><span class="pre">L(r)</span></code> selects ligand molecules that have an unbound <code class="docutils literal"><span class="pre">r</span></code>
component.  Since L molecules have only one component, the only species that
is selected by this pattern is <code class="docutils literal"><span class="pre">L(r)</span></code>.  When multiple reactant or product
patterns appear in a rule, they are separated by the &#8216;+&#8217; character.  The
<code class="docutils literal"><span class="pre">R(l,d)</span></code> pattern selects <code class="docutils literal"><span class="pre">R</span></code> molecules with unbound l and d components regardless
of the phosphorylation state of the Y component.  It would, for example select
the species <code class="docutils literal"><span class="pre">R(l,d,Y~U)</span></code> and <code class="docutils literal"><span class="pre">R(l,d,Y~P)</span></code>.  By specifying the component d and not
indicating any binding state, we are requiring that the <code class="docutils literal"><span class="pre">d</span></code> component be
unbound.  We could have written the rule to be independent of the state of d
by simply omitting it from <code class="docutils literal"><span class="pre">R</span></code>, which would allow the ligand to associate with <code class="docutils literal"><span class="pre">R</span></code>
molecules that have formed dimers.  The general principle is that reaction
rules should only include molecules, components, states, and edges that are
either required for the reaction to occur or are modified by the reaction.
The bidirectional arrow indicates that the rule is to be applied in
both the forward and reverse directions.  A unidirectional (forward only)
reaction is specified by the &#8216;-&gt;&#8217; arrow.  The rate laws appear after the product
patterns.  For reversible reactions two rate laws are required, separated by
commas.  Here, each rate law is given by a single parameter, indicating that
elementary rate laws are to be used.  Additional arguments may appear after
the rate constants to modify the behavior of the rule, but these will be
discussed in a future tutorial.</p>
<div class="section" id="other-rate-laws">
<h2>Other rate laws<a class="headerlink" href="#other-rate-laws" title="Permalink to this headline">¶</a></h2>
<p>Other rate laws can be invoked using one of the keywords for the allowed rate
law types followed by a list of parameters in the parenthesis.  The two rate
law types covered here are Sat and MM.</p>
<p>The reaction</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>S + E -&gt; P + E Sat(kcat,Km)
</pre></div>
</div>
<p>will have the rate law, rate= kcat*[S]*[E]/(Km + [S]).  Note that the term in
the denominator must appear first in the reaction rule.</p>
<p>There is also a MM rate law type that gives the rate of the reaction corrected
for the amount of <code class="docutils literal"><span class="pre">S</span></code> bound in the <code class="docutils literal"><span class="pre">ES</span></code> complex (solves quadratic formula for
[S]free).  This will give a closer approximation to the kinetics of the two
elementary processes.  The reaction</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>S + E -&gt; P + E MM(kcat,Km)
</pre></div>
</div>
<p>will have the rate law, rate= kcat*[S]_free*[E]/(Km + [S]_free), where
[S]_free is determined by</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>[S]_free= 0.5*(([S]-Km-[E]) + ( ([S]-Km-[E])^2 + 4*Km*[S])^(1/2) )
</pre></div>
</div>
<p>The transformation in the above rule results in two separate species, one
matching the first pattern and one matching the second, being combined into a
single species joined by a new bond between the matched molecule <code class="docutils literal"><span class="pre">L</span></code> component <code class="docutils literal"><span class="pre">r</span></code>
and the matched molecule <code class="docutils literal"><span class="pre">R</span></code> component <code class="docutils literal"><span class="pre">l</span></code>.  The component <code class="docutils literal"><span class="pre">d</span></code> is not modified, but
it must be in an unbound state for the reaction to occur.  The reverse
transformation involves the breaking of a bond between <code class="docutils literal"><span class="pre">L</span></code> and <code class="docutils literal"><span class="pre">R</span></code> to create two
separate species.  Here are some examples of specific reactions generated by this rule:</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>L(r) + R(l,d,Y~U) -&gt; L(r!1).R(l!1,d,Y~U) kp1
L(r!1).R(l!1,d,Y~U) -&gt; L(r) + R(l,d,Y~U) km1
L(r) + R(l,d,Y~P) -&gt; L(r!1).R(l!1,d,Y~P) kp1
L(r) + R(l,d,Y~P!1).A(SH2!1) -&gt; L(r!2).R(l!2,d,Y~P!1).A(SH2!1) kp1
</pre></div>
</div>
<p>Note that the &#8216;+&#8217; operator in the rule above has a restrictive effect:
if the breaking of the bond between <code class="docutils literal"><span class="pre">L</span></code> and <code class="docutils literal"><span class="pre">R</span></code> does not product two separate
species (not joined by any bond), then the rule is not applied and no reaction
is generated.  This is a general property of rules that the number of product
species must equal the number of product patterns of the rule.  Thus,
intramolecular and intermolecular dissociation must be handled as separate
rules. For example, suppose that <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">B</span></code> joined by a direct bond in a complex,
but may also be joined indirectly by unspecified molecules.  In the latter
case, breaking of the direct bond between <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">B</span></code> would not break up the
complex containing both.  If the only rule given for the dissociation of the
direct bond were</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>A(b!1).B(a!1) -&gt; A(b!1) + B(a!1) kmAB
</pre></div>
</div>
<p>the bond between <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">B</span></code> would not break inside a complex containing an
indirect link.  To allow this bond to break, we would need the additional rule</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>A(b!1).B(a!1) -&gt; A(b).B(a) kmAB
</pre></div>
</div>
<p>for intramolecular bond dissociation.  In the future, we might provide syntax
allowing both types of bond breakage to be specified in a single rule.</p>
<p>Let us now consider a rule for receptor dimerization that introduces some new
syntactic features:</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>R(l!+,d) + R(l!+,d) &lt;-&gt; R(l!+,d!2).R(l!+,d!2) kp2, km2
</pre></div>
</div>
<p>The rule specifies that two species each containing a receptor with a bound <code class="docutils literal"><span class="pre">l</span></code>
component and an unbound <code class="docutils literal"><span class="pre">d</span></code> component may be joined by a bond connecting the
unbound d components.  The fact the l must be bound is specified by the edge
label <code class="docutils literal"><span class="pre">!+</span></code>, where the <code class="docutils literal"><span class="pre">+</span></code> character must match one or more bonds, analogous to its
meaning within a regular expression.  Because this rule is symmetric on both
the reactant and product sides (with respect to interchange of the <code class="docutils literal"><span class="pre">R</span></code> molecule
patterns), each set of possible reactants will have two identical matches
causing each reaction to be generated twice.  In the past it was necessary to
add a multiplicative factor of 0.5 to forward and reverse rate constants, but
this is no longer necessary as BioNetGen automatically adjusts for the
symmetry of reaction rules [see Faeder 2005a or Blinov 2005].</p>
<p>As a final example we consider two rules that change the phosphorylation state
of the receptor:</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>R(d!+,Y~U) -&gt; R(d!+,Y~P) p1
R(Y~P) -&gt; R(Y~U) d1
</pre></div>
</div>
<p>The first rule states that the phosphorylation reaction occurs only when the
receptor dimerization domain (<code class="docutils literal"><span class="pre">d</span></code>) is bound, i.e. phosphorylation occurs within
a dimer. The second rule allows dephosphorylation to take place regardless of
the state of the dimerization domain (or any other component of <code class="docutils literal"><span class="pre">R</span></code>) provided
that the <code class="docutils literal"><span class="pre">Y</span></code> component is unbound.  Similarly, the first rule also requires that
<code class="docutils literal"><span class="pre">Y</span></code> is unbound when it is phosphorylated, presumably because the catalytic
domain of the kinase or phosphatase must be able to access the tyrosine
residue.  Let&#8217;s consider application of the first rule to the complex
<code class="docutils literal"><span class="pre">L(r!1).R(l!1,d!2,Y~U).L(r!1).R(l!1,d!2,Y~U)</span></code>, a dimer of two ligand-bound
unphosphorylated receptors.  The reactant pattern <code class="docutils literal"><span class="pre">R(d!+,Y~U)</span></code> has two instances
in this complex because it matches either the first or second receptor.  Thus,
the rule will be applied twice to this species, each generating an instance of the reaction</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>L(r!1).R(l!1,d!2,Y~U).L(r!1).R(l!1,d!2,Y~U) -&gt; \
L(r!1).R(l!1,d!2,Y~U).L(r!1).R(l!1,d!2,Y~P) p1
</pre></div>
</div>
<p>Note that the &#8216;&#8217;character at the end of the line can be used to continue a
single line, which is necessary because all block entries must be contained on
a single line in both BNGL and NET files.  If the species index of the
reactant and product are 20 and 21 respectively, this reaction (index 43)
would appear in the NET file specifying the reaction network as</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>43 20 21 2*p1
</pre></div>
</div>
<p>indicating that reaction 43 is the unimolecular reaction transforming species
20 into species 21 with rate 2*p1*[S20].  The square brackets indicate
concentration of species 20.  The multiplicative factor of 2 arises because
there are two ways this transformation can occur, and unlike the symmetric
case above, these paths correspond to distinct physical mechanisms.</p>
</div>
</div>


    </div>
  </div>
</div>
<footer class="footer">
  <div class="row">
    <div class="span12">
      <p><small>
      &copy; Copyright 2010-2017, University of Pittsburgh.
      Last updated on Dec 21, 2017.
      Created using <a href="http://sphinx-doc.org">Sphinx</a> 1.3.5.
      </small></p>
    </div>
  </div>
  </div>
</footer>
<div id="codemodal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Code Snippets</h3>
  </div>
  <div class="modal-body">
    <textarea id="codesnippets"></textarea>
  </div>
  <div class="modal-footer">
    <button class="btn btn-info" id="selectcode">Select Code</button>
    <!--
    <button class="btn btn-success" id="copycode" data-clipboard-target="codesnippets">Copy Code</button>
    -->
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
  <input type="hidden" id="zeroclipboardpath" value="../../_static/js/zeroclipboard.swf">
</div>
  </body>
</html>