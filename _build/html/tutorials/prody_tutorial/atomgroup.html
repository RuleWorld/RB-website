
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-19801227-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Atom Groups &mdash; RuleBender</title>
    <link rel="stylesheet" href="../../_static/css/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootswatch-united.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/prodydocs.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/js/jquery-2.0.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/js/zeroclipboard.min.js"></script>
    <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/js/prodydocs.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>

  </head>
  <body data-spy="scroll" data-target="#localtoc" data-offset="190">

<div class="container">
  <div class="row">
    <div class="span12">
      <a href="../../index.html">
        <img src="../../_static/logo.png" alt="ProDy logo" id="logo" />
      </a>
    </div>
    <div class="span12">
      <div class="subnav">
        <ul class="nav nav-pills">
        <li class="pull-right">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a>
          </li>
        <li class="pull-right">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a>
          </li>
        <li><a href="../../index.html">Home  &raquo;</a></li> 
        </ul>
      </div>
    </div>
  </div>

  <div class="content">
  <div class="row">
    <div class="span3">
      <div id="sidebar" style="width: 220px">
  <div id="localtoc" style="margin-bottom: 20px">
    <ul>
<li><a class="reference internal" href="#">Atom Groups</a><ul>
<li><a class="reference internal" href="#building-an-atom-group">Building an Atom Group</a><ul>
<li><a class="reference internal" href="#attributes">Attributes</a></li>
<li><a class="reference internal" href="#atoms">Atoms</a><ul>
<li><a class="reference internal" href="#iteration">Iteration</a></li>
<li><a class="reference internal" href="#indexing">Indexing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coordinate-sets">Coordinate sets</a><ul>
<li><a class="reference internal" href="#iterations">Iterations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#copying-and-merging">Copying and Merging</a><ul>
<li><a class="reference internal" href="#translate-copy">Translate copy</a></li>
<li><a class="reference internal" href="#change-attributes">Change attributes</a></li>
<li><a class="reference internal" href="#merge-two-copies">Merge two copies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hierarchical-views">Hierarchical views</a></li>
<li><a class="reference internal" href="#renaming-an-atom-group">Renaming an atom group</a></li>
</ul>
</li>
<li><a class="reference internal" href="#storing-data-in-atomgroup">Storing data in AtomGroup</a><ul>
<li><a class="reference internal" href="#set-a-new-attribute">Set a new attribute</a></li>
<li><a class="reference internal" href="#access-subset-of-data">Access subset of data</a></li>
<li><a class="reference internal" href="#make-selections">Make selections</a></li>
<li><a class="reference internal" href="#save-attributes">Save attributes</a></li>
<li><a class="reference internal" href="#delete-an-attribute">Delete an attribute</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
        <div class="accordion" id="accordion2">
  <div id="searchbox" class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseToolbox">
        <strong>Toolbox</strong>
      </a>
    </div>
<!--     <div id="collapseToolbox" class="accordion-body collapse in">
      <div class="accordion-inner">
        <div id="showcodebuttons" style="margin-bottom: 10px">
          <p><small>Show code snippets for copying:</small></p>
          <div class="btn-group">
            <a href="#codemodal" role="button" data-toggle="modal" id="showcode" class="btn btn-primary btn-small">
              <i class="icon-fullscreen icon-white"></i> Show code</a>
            <a href="#codemodal" role="button" data-toggle="modal" id="withcomments" class="btn btn-primary btn-small">
              and output <i class="icon-comment icon-white"></i> </a>
          </div>
        </div> -->

        <p><small>Search terms or function by name:</small></p>
        <form class="form-search pull-right" action="../../search.html" method="get">
          <div class="input-append">
            <input type="text" class="input-small search-query" name="q" class="span2">
            <button type="submit" class="btn btn-primary">Go</button>
          </div>
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
      </div>
    </div>
  </div>  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseReleaseNotes">
        <strong>Release Notes</strong>
      </a>
    </div>
    <div id="collapseReleaseNotes" class="accordion-body collapse in">
      <div class="accordion-inner">
        <p><small><strong>v1</strong> series come with new and improved sequence, structure, and dynamics analysis
features. See <a href="../../manual/release/index.html">release notes</a> for details.
        </small></p>
      </div>
    </div>
  </div>  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseHowToCite">
        <strong>How to Cite</strong>
      </a>
    </div>
    <div id="collapseHowToCite" class="accordion-body collapse in">
      <div class="accordion-inner">
        <p><small>
          Bakan A, Meireles LM, Bahar I
          <a class="reference external" href="http://bioinformatics.oxfordjournals.org/content/27/11/1575" target="_blank">
          <i>ProDy</i>: Protein Dynamics Inferred from Theory and Experiments</a> <br/>
          <em>Bioinformatics</em> <strong>2011</strong> 27(11):1575-1577.
        </small></p>
      </div>
    </div>
  </div>
        </div>
      </div>
    </div>
    <div class="span9 body">
    
  <div class="section" id="atom-groups">
<span id="atomgroup"></span><h1>Atom Groups<a class="headerlink" href="#atom-groups" title="Permalink to this headline">¶</a></h1>
<p>Below example shows how to build an <a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup" title="prody.atomic.atomgroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> from scratch.  We start
by importing everything from the ProDy package and the NumPy package:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">prody</span> <span class="kn">import</span> <span class="o">*</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="gp">In [3]: </span><span class="n">ion</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="building-an-atom-group">
<h2>Building an Atom Group<a class="headerlink" href="#building-an-atom-group" title="Permalink to this headline">¶</a></h2>
<p>The best way to start constructing an <a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup" title="prody.atomic.atomgroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> is by setting the
coordinates first. Number of atoms will be automatically set according to
the size of the coordinate data array:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">wtr1</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="p">(</span><span class="s1">&#39;Water&#39;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">wtr1</span>
<span class="gh">Out[5]: </span><span class="go">&lt;AtomGroup: Water (0 atoms; no coordinates)&gt;</span>

<span class="gp">In [6]: </span><span class="n">coords</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">coords</span>
<span class="gh">Out[7]: </span><span class="go"></span>
<span class="go">array([[ 1.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.]])</span>

<span class="gp">In [8]: </span><span class="n">wtr1</span><span class="o">.</span><span class="n">setCoords</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">wtr1</span>
<span class="gh">Out[9]: </span><span class="go">&lt;AtomGroup: Water (3 atoms)&gt;</span>
</pre></div>
</div>
<div class="section" id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<p>Attributes must be passed in a list or an array whose size is the same
as the number of atoms.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">wtr1</span><span class="o">.</span><span class="n">setNames</span><span class="p">([</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>

<span class="gp">In [11]: </span><span class="n">wtr1</span><span class="o">.</span><span class="n">setResnums</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="gp">In [12]: </span><span class="n">wtr1</span><span class="o">.</span><span class="n">setResnames</span><span class="p">([</span><span class="s1">&#39;WAT&#39;</span><span class="p">,</span> <span class="s1">&#39;WAT&#39;</span><span class="p">,</span> <span class="s1">&#39;WAT&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Accessing data will return a copy of the data:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">wtr1</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>
<span class="gh">Out[13]: </span><span class="go"></span>
<span class="go">array([&#39;H&#39;, &#39;O&#39;, &#39;H&#39;], </span>
<span class="go">      dtype=&#39;|S6&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="atoms">
<h3>Atoms<a class="headerlink" href="#atoms" title="Permalink to this headline">¶</a></h3>
<p>Atoms are represented by instance of <a class="reference internal" href="../../manual/reference/atomic/atom.html#prody.atomic.atom.Atom" title="prody.atomic.atom.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a>.</p>
<div class="section" id="iteration">
<h4>Iteration<a class="headerlink" href="#iteration" title="Permalink to this headline">¶</a></h4>
<p>Atoms in an <a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup" title="prody.atomic.atomgroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> can be iterated over</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">wtr1</span><span class="p">:</span> <span class="n">a</span>
</pre></div>
</div>
</div>
<div class="section" id="indexing">
<h4>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h4>
<p>Atoms in an atom group can be accessed via indexing:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">a</span> <span class="o">=</span> <span class="n">wtr1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [16]: </span><span class="n">a</span>
<span class="gh">Out[16]: </span><span class="go">&lt;Atom: H from Water (index 0)&gt;</span>

<span class="gp">In [17]: </span><span class="n">a</span><span class="o">.</span><span class="n">getCoords</span><span class="p">()</span>
<span class="gh">Out[17]: </span><span class="go">array([ 1.,  0.,  0.])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="coordinate-sets">
<h3>Coordinate sets<a class="headerlink" href="#coordinate-sets" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s add another coordinate set to the atom group:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">wtr1</span><span class="o">.</span><span class="n">addCoordset</span><span class="p">(</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span>

<span class="gp">In [19]: </span><span class="n">wtr1</span>
<span class="gh">Out[19]: </span><span class="go">&lt;AtomGroup: Water (3 atoms; active #0 of 2 coordsets)&gt;</span>
</pre></div>
</div>
<p>Note that number of coordinate sets is now 2, but active coordinate set index
is still 0. Active coordinate set index can be changed for <a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup" title="prody.atomic.atomgroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">a</span><span class="o">.</span><span class="n">setACSIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [21]: </span><span class="n">a</span>
<span class="gh">Out[21]: </span><span class="go">&lt;Atom: H from Water (index 0; active #1 of 2 coordsets)&gt;</span>
</pre></div>
</div>
<p>Changing active coordinate set for an atom group, does not affect the active
coordinate set of the atom group:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">wtr1</span>
<span class="gh">Out[22]: </span><span class="go">&lt;AtomGroup: Water (3 atoms; active #0 of 2 coordsets)&gt;</span>
</pre></div>
</div>
<p>Coordinates for the atom group will be returned from the active coordinate set</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">a</span><span class="o">.</span><span class="n">getCoords</span><span class="p">()</span>
<span class="gh">Out[23]: </span><span class="go">array([ 0.,  1.,  0.])</span>
</pre></div>
</div>
<div class="section" id="iterations">
<h4>Iterations<a class="headerlink" href="#iterations" title="Permalink to this headline">¶</a></h4>
<p>Coordinate sets can also be iterated over for <a class="reference internal" href="../../manual/reference/atomic/atom.html#prody.atomic.atom.Atom" title="prody.atomic.atom.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> and
<a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup" title="prody.atomic.atomgroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> instances:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="k">for</span> <span class="n">xyz</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">iterCoordsets</span><span class="p">():</span> <span class="n">xyz</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="copying-and-merging">
<h3>Copying and Merging<a class="headerlink" href="#copying-and-merging" title="Permalink to this headline">¶</a></h3>
<p>Now let&#8217;s make another copy of this water:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">wtr2</span> <span class="o">=</span> <span class="n">wtr1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [26]: </span><span class="n">wtr2</span>
<span class="gh">Out[26]: </span><span class="go">&lt;AtomGroup: Water (3 atoms; active #0 of 2 coordsets)&gt;</span>
</pre></div>
</div>
<div class="section" id="translate-copy">
<h4>Translate copy<a class="headerlink" href="#translate-copy" title="Permalink to this headline">¶</a></h4>
<p>Let&#8217;s translate the coordinates of wtr2 so that it does not overlap with wtr1</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [27]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">setCoords</span><span class="p">(</span><span class="n">wtr2</span><span class="o">.</span><span class="n">getCoords</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">In [28]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">getCoords</span><span class="p">()</span>
<span class="gh">Out[28]: </span><span class="go"></span>
<span class="go">array([[ 3.,  2.,  2.],</span>
<span class="go">       [ 2.,  2.,  2.],</span>
<span class="go">       [ 2.,  2.,  3.]])</span>
</pre></div>
</div>
<p>Above operation only translated the coordinate set at index 0</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">setACSIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [30]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">getCoords</span><span class="p">()</span>
<span class="gh">Out[30]: </span><span class="go"></span>
<span class="go">array([[ 0.,  1.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.]])</span>

<span class="gp">In [31]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">setCoords</span><span class="p">(</span><span class="n">wtr2</span><span class="o">.</span><span class="n">getCoords</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># translate the 2nd coordset as well</span>
</pre></div>
</div>
</div>
<div class="section" id="change-attributes">
<h4>Change attributes<a class="headerlink" href="#change-attributes" title="Permalink to this headline">¶</a></h4>
<p>Before we merge wtr1 and wtr2, let&#8217;s change resid&#8217;s of wtr2:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [32]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">setResnums</span><span class="p">(</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">)</span>

<span class="gp">In [33]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">getResnums</span><span class="p">()</span>
<span class="gh">Out[33]: </span><span class="go">array([2, 2, 2])</span>
</pre></div>
</div>
<p>We can do this in an alternate way too:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setResnums</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [35]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">getResnums</span><span class="p">()</span>
<span class="gh">Out[35]: </span><span class="go">array([2, 2, 2])</span>
</pre></div>
</div>
<p>Note that the following won&#8217;t work:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [36]: </span><span class="n">wtr2</span><span class="o">.</span><span class="n">setResnums</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-36-50a17a045d31&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">wtr2</span><span class="o">.</span><span class="n">setResnums</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nn">/home/cihank/anaconda2/lib/python2.7/site-packages/prody/atomic/fields.pyc</span> in <span class="ni">setMethod</span><span class="nt">(self, data)</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span> <span class="k">def</span> <span class="nf">wrapSetMethod</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span>     <span class="k">def</span> <span class="nf">setMethod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">263</span>         <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span>     <span class="k">return</span> <span class="n">setMethod</span>

<span class="nn">/home/cihank/anaconda2/lib/python2.7/site-packages/prody/atomic/atomgroup.pyc</span> in <span class="ni">setData</span><span class="nt">(self, array, var, dtype, ndim, none, flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1153</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1154</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_n_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1155</span>             <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_atoms</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1156</span>                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;length of array must match number &#39;</span>
<span class="g g-Whitespace">   </span><span class="mi">1157</span>                                  <span class="s1">&#39;of atoms&#39;</span><span class="p">)</span>

<span class="ne">TypeError</span>: object of type &#39;int&#39; has no len()
</pre></div>
</div>
</div>
<div class="section" id="merge-two-copies">
<h4>Merge two copies<a class="headerlink" href="#merge-two-copies" title="Permalink to this headline">¶</a></h4>
<p>Let&#8217;s merge two water atom groups:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [37]: </span><span class="n">wtrs</span> <span class="o">=</span> <span class="n">wtr1</span> <span class="o">+</span> <span class="n">wtr2</span>

<span class="gp">In [38]: </span><span class="n">wtrs</span>
<span class="gh">Out[38]: </span><span class="go">&lt;AtomGroup: Water + Water (6 atoms; active #0 of 2 coordsets)&gt;</span>

<span class="gp">In [39]: </span><span class="n">wtrs</span><span class="o">.</span><span class="n">getCoords</span><span class="p">()</span>
<span class="gh">Out[39]: </span><span class="go"></span>
<span class="go">array([[ 1.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.],</span>
<span class="go">       [ 3.,  2.,  2.],</span>
<span class="go">       [ 2.,  2.,  2.],</span>
<span class="go">       [ 2.,  2.,  3.]])</span>

<span class="gp">In [40]: </span><span class="n">wtrs</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>
<span class="gh">Out[40]: </span><span class="go"></span>
<span class="go">array([&#39;H&#39;, &#39;O&#39;, &#39;H&#39;, &#39;H&#39;, &#39;O&#39;, &#39;H&#39;], </span>
<span class="go">      dtype=&#39;|S6&#39;)</span>

<span class="gp">In [41]: </span><span class="n">wtrs</span><span class="o">.</span><span class="n">getResnums</span><span class="p">()</span>
<span class="gh">Out[41]: </span><span class="go">array([1, 1, 1, 2, 2, 2])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="hierarchical-views">
<h3>Hierarchical views<a class="headerlink" href="#hierarchical-views" title="Permalink to this headline">¶</a></h3>
<p>Hierarchical views of atom groups are represented by <a class="reference internal" href="../../manual/reference/atomic/hierview.html#prody.atomic.hierview.HierView" title="prody.atomic.hierview.HierView"><code class="xref py py-class docutils literal"><span class="pre">HierView</span></code></a>.</p>
<p>Residues (and also chains) in an atom group can also be iterated over</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">wtrs</span><span class="o">.</span><span class="n">getHierView</span><span class="p">()</span><span class="o">.</span><span class="n">iterResidues</span><span class="p">():</span> <span class="n">res</span>
</pre></div>
</div>
</div>
<div class="section" id="renaming-an-atom-group">
<h3>Renaming an atom group<a class="headerlink" href="#renaming-an-atom-group" title="Permalink to this headline">¶</a></h3>
<p>Finally, it&#8217;s is possible to change the name of <em>wtrs</em> from
&#8220;Water + Water&#8221; to something shorter:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [43]: </span><span class="n">wtrs</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s1">&#39;2Waters&#39;</span><span class="p">)</span>

<span class="gp">In [44]: </span><span class="n">wtrs</span>
<span class="gh">Out[44]: </span><span class="go">&lt;AtomGroup: 2Waters (6 atoms; active #0 of 2 coordsets)&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="storing-data-in-atomgroup">
<span id="id1"></span><h2>Storing data in AtomGroup<a class="headerlink" href="#storing-data-in-atomgroup" title="Permalink to this headline">¶</a></h2>
<p>Now let&#8217;s get an atom group from a PDB file:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">structure</span> <span class="o">=</span> <span class="n">parsePDB</span><span class="p">(</span><span class="s1">&#39;1p38&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition to what&#8217;s in a PDB file, you can store arbitrary atomic attributes
in <a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup" title="prody.atomic.atomgroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> objects.</p>
<div class="section" id="set-a-new-attribute">
<h3>Set a new attribute<a class="headerlink" href="#set-a-new-attribute" title="Permalink to this headline">¶</a></h3>
<p>For the purposes of this example, we will manufacture atomic data by
dividing the residue number of each atom by 10:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">myresnum</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">getResnums</span><span class="p">()</span> <span class="o">/</span> <span class="mf">10.0</span>
</pre></div>
</div>
<p>We will add this to the atom group using <a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup.setData" title="prody.atomic.atomgroup.AtomGroup.setData"><code class="xref py py-meth docutils literal"><span class="pre">AtomGroup.setData()</span></code></a>
method by passing a name for the attribute and the data:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [47]: </span><span class="n">structure</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="s1">&#39;myresnum&#39;</span><span class="p">,</span> <span class="n">myresnum</span><span class="p">)</span>
</pre></div>
</div>
<p>We can check if a custom atomic attribute exists using
<a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup.isDataLabel" title="prody.atomic.atomgroup.AtomGroup.isDataLabel"><code class="xref py py-meth docutils literal"><span class="pre">AtomGroup.isDataLabel()</span></code></a> method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [48]: </span><span class="n">structure</span><span class="o">.</span><span class="n">isDataLabel</span><span class="p">(</span><span class="s1">&#39;myresnum&#39;</span><span class="p">)</span>
<span class="gh">Out[48]: </span><span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="access-subset-of-data">
<h3>Access subset of data<a class="headerlink" href="#access-subset-of-data" title="Permalink to this headline">¶</a></h3>
<p>Custom attributes can be accessed from selections:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [49]: </span><span class="n">calpha</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">calpha</span>

<span class="gp">In [50]: </span><span class="n">calpha</span><span class="o">.</span><span class="n">getData</span><span class="p">(</span><span class="s1">&#39;myresnum&#39;</span><span class="p">)</span>
<span class="gh">Out[50]: </span><span class="go"></span>
<span class="go">array([  0.4,   0.5,   0.6,   0.7,   0.8,   0.9,   1. ,   1.1,   1.2,</span>
<span class="go">         1.3,   1.4,   1.5,   1.6,   1.7,   1.8,   1.9,   2. ,   2.1,</span>
<span class="go">         2.2,   2.3,   2.4,   2.5,   2.6,   2.7,   2.8,   2.9,   3. ,</span>
<span class="go">         3.1,   3.2,   3.3,   3.4,   3.5,   3.6,   3.7,   3.8,   3.9,</span>
<span class="go">         4. ,   4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,</span>
<span class="go">         4.9,   5. ,   5.1,   5.2,   5.3,   5.4,   5.5,   5.6,   5.7,</span>
<span class="go">         5.8,   5.9,   6. ,   6.1,   6.2,   6.3,   6.4,   6.5,   6.6,</span>
<span class="go">         6.7,   6.8,   6.9,   7. ,   7.1,   7.2,   7.3,   7.4,   7.5,</span>
<span class="go">         7.6,   7.7,   7.8,   7.9,   8. ,   8.1,   8.2,   8.3,   8.4,</span>
<span class="go">         8.5,   8.6,   8.7,   8.8,   8.9,   9. ,   9.1,   9.2,   9.3,</span>
<span class="go">         9.4,   9.5,   9.6,   9.7,   9.8,   9.9,  10. ,  10.1,  10.2,</span>
<span class="go">        10.3,  10.4,  10.5,  10.6,  10.7,  10.8,  10.9,  11. ,  11.1,</span>
<span class="go">        11.2,  11.3,  11.4,  11.5,  11.6,  11.7,  11.8,  11.9,  12. ,</span>
<span class="go">        12.1,  12.2,  12.3,  12.4,  12.5,  12.6,  12.7,  12.8,  12.9,</span>
<span class="go">        13. ,  13.1,  13.2,  13.3,  13.4,  13.5,  13.6,  13.7,  13.8,</span>
<span class="go">        13.9,  14. ,  14.1,  14.2,  14.3,  14.4,  14.5,  14.6,  14.7,</span>
<span class="go">        14.8,  14.9,  15. ,  15.1,  15.2,  15.3,  15.4,  15.5,  15.6,</span>
<span class="go">        15.7,  15.8,  15.9,  16. ,  16.1,  16.2,  16.3,  16.4,  16.5,</span>
<span class="go">        16.6,  16.7,  16.8,  16.9,  17. ,  17.1,  17.2,  17.3,  17.4,</span>
<span class="go">        17.5,  17.6,  17.7,  17.8,  17.9,  18. ,  18.1,  18.2,  18.3,</span>
<span class="go">        18.4,  18.5,  18.6,  18.7,  18.8,  18.9,  19. ,  19.1,  19.2,</span>
<span class="go">        19.3,  19.4,  19.5,  19.6,  19.7,  19.8,  19.9,  20. ,  20.1,</span>
<span class="go">        20.2,  20.3,  20.4,  20.5,  20.6,  20.7,  20.8,  20.9,  21. ,</span>
<span class="go">        21.1,  21.2,  21.3,  21.4,  21.5,  21.6,  21.7,  21.8,  21.9,</span>
<span class="go">        22. ,  22.1,  22.2,  22.3,  22.4,  22.5,  22.6,  22.7,  22.8,</span>
<span class="go">        22.9,  23. ,  23.1,  23.2,  23.3,  23.4,  23.5,  23.6,  23.7,</span>
<span class="go">        23.8,  23.9,  24. ,  24.1,  24.2,  24.3,  24.4,  24.5,  24.6,</span>
<span class="go">        24.7,  24.8,  24.9,  25. ,  25.1,  25.2,  25.3,  25.4,  25.5,</span>
<span class="go">        25.6,  25.7,  25.8,  25.9,  26. ,  26.1,  26.2,  26.3,  26.4,</span>
<span class="go">        26.5,  26.6,  26.7,  26.8,  26.9,  27. ,  27.1,  27.2,  27.3,</span>
<span class="go">        27.4,  27.5,  27.6,  27.7,  27.8,  27.9,  28. ,  28.1,  28.2,</span>
<span class="go">        28.3,  28.4,  28.5,  28.6,  28.7,  28.8,  28.9,  29. ,  29.1,</span>
<span class="go">        29.2,  29.3,  29.4,  29.5,  29.6,  29.7,  29.8,  29.9,  30. ,</span>
<span class="go">        30.1,  30.2,  30.3,  30.4,  30.5,  30.6,  30.7,  30.8,  30.9,</span>
<span class="go">        31. ,  31.1,  31.2,  31.3,  31.4,  31.5,  31.6,  31.7,  31.8,</span>
<span class="go">        31.9,  32. ,  32.1,  32.2,  32.3,  32.4,  32.5,  32.6,  32.7,</span>
<span class="go">        32.8,  32.9,  33. ,  33.1,  33.2,  33.3,  33.4,  33.5,  33.6,</span>
<span class="go">        33.7,  33.8,  33.9,  34. ,  34.1,  34.2,  34.3,  34.4,  34.5,</span>
<span class="go">        34.6,  34.7,  34.8,  34.9,  35. ,  35.1,  35.2,  35.3,  35.4])</span>
</pre></div>
</div>
</div>
<div class="section" id="make-selections">
<h3>Make selections<a class="headerlink" href="#make-selections" title="Permalink to this headline">¶</a></h3>
<p>Custom atomic attributes can be used in selections:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [51]: </span><span class="n">mysel</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;0 &lt; myresnum and myresnum &lt; 10&#39;</span><span class="p">)</span>

<span class="gp">In [52]: </span><span class="n">mysel</span>
<span class="gh">Out[52]: </span><span class="go">&lt;Selection: &#39;0 &lt; myresnum and myresnum &lt; 10&#39; from 1p38 (788 atoms)&gt;</span>
</pre></div>
</div>
<p>This gives the same result as the following selection:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [53]: </span><span class="n">structure</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;0 &lt; resnum and resnum &lt; 100&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">mysel</span>
<span class="gh">Out[53]: </span><span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="save-attributes">
<h3>Save attributes<a class="headerlink" href="#save-attributes" title="Permalink to this headline">¶</a></h3>
<p>It is not possible to save custom attributes in PDB files, but
<a class="reference internal" href="../../manual/reference/atomic/functions.html#prody.atomic.functions.saveAtoms" title="prody.atomic.functions.saveAtoms"><code class="xref py py-func docutils literal"><span class="pre">saveAtoms()</span></code></a> function can be used them to save in disk for later use:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [54]: </span><span class="n">saveAtoms</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
<span class="gh">Out[54]: </span><span class="go">&#39;1p38.ag.npz&#39;</span>
</pre></div>
</div>
<p>Let&#8217;s load it using <a class="reference internal" href="../../manual/reference/atomic/functions.html#prody.atomic.functions.loadAtoms" title="prody.atomic.functions.loadAtoms"><code class="xref py py-func docutils literal"><span class="pre">loadAtoms()</span></code></a> function:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [55]: </span><span class="n">structure</span> <span class="o">=</span> <span class="n">loadAtoms</span><span class="p">(</span><span class="s1">&#39;1p38.ag.npz&#39;</span><span class="p">)</span>

<span class="gp">In [56]: </span><span class="n">structure</span><span class="o">.</span><span class="n">getData</span><span class="p">(</span><span class="s1">&#39;myresnum&#39;</span><span class="p">)</span>
<span class="gh">Out[56]: </span><span class="go">array([  0.4,   0.4,   0.4, ...,  77.1,  77.3,  77.6])</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-an-attribute">
<h3>Delete an attribute<a class="headerlink" href="#delete-an-attribute" title="Permalink to this headline">¶</a></h3>
<p>Finally, when done with an attribute, it can be deleted using
<a class="reference internal" href="../../manual/reference/atomic/atomgroup.html#prody.atomic.atomgroup.AtomGroup.delData" title="prody.atomic.atomgroup.AtomGroup.delData"><code class="xref py py-meth docutils literal"><span class="pre">AtomGroup.delData()</span></code></a> method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [57]: </span><span class="n">structure</span><span class="o">.</span><span class="n">delData</span><span class="p">(</span><span class="s1">&#39;myresnum&#39;</span><span class="p">)</span>
<span class="gh">Out[57]: </span><span class="go">array([  0.4,   0.4,   0.4, ...,  77.1,  77.3,  77.6])</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
  </div>
</div>
<footer class="footer">
  <div class="row">
    <div class="span12">
      <p><small>
      &copy; Copyright 2010-2017, University of Pittsburgh.
      Last updated on Dec 06, 2017.
      Created using <a href="http://sphinx-doc.org">Sphinx</a> 1.3.5.
      </small></p>
    </div>
  </div>
  </div>
</footer>
<div id="codemodal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Code Snippets</h3>
  </div>
  <div class="modal-body">
    <textarea id="codesnippets"></textarea>
  </div>
  <div class="modal-footer">
    <button class="btn btn-info" id="selectcode">Select Code</button>
    <!--
    <button class="btn btn-success" id="copycode" data-clipboard-target="codesnippets">Copy Code</button>
    -->
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
  <input type="hidden" id="zeroclipboardpath" value="../../_static/js/zeroclipboard.swf">
</div>
  </body>
</html>