
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-19801227-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Simulating ODEs &mdash; RuleBender</title>
    <link rel="stylesheet" href="../../_static/css/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootswatch-united.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/rbdocs.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/js/jquery-2.0.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/js/zeroclipboard.min.js"></script>
    <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/js/rbdocs.js"></script>
    <link rel="shortcut icon" href="../../_static/bionetgen.ico"/>

  </head>
  <body data-spy="scroll" data-target="#localtoc" data-offset="190">

<div class="container">
  <div class="row">
    <div class="span12">
      <a href="../../index.html">
        <img src="../../_static/bionetgen_logo.png" alt="BNG logo" id="logo" />
      </a>
    </div>
    <div class="span12">
      <div class="subnav">
        <ul class="nav nav-pills">
        <li class="pull-right">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a>
          </li>
        <li class="pull-right">
          <a href="ssa.html" title="Simulating SSAs"
             accesskey="N">next</a>
          </li>
        <li class="pull-right">
          <a href="network.html" title="Generating Network"
             accesskey="P">previous</a>
          </li>
        <li><a href="../../index.html">Home  &raquo;</a></li>
          <li><a href="index.html" accesskey="U">BioNetGen Online Manual &raquo;</a></li> 
        </ul>
      </div>
    </div>
  </div>

  <div class="content">
  <div class="row">
    <div class="span3">
      <div id="sidebar" style="width: 220px">
        <div class="accordion" id="accordion2">
  <div id="searchbox" class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseToolbox">
        <strong>Toolbox</strong>
      </a>
    </div>
    <div id="collapseToolbox" class="accordion-body collapse in">
      <div class="accordion-inner">
        <div id="showcodebuttons" style="margin-bottom: 10px">
          <p><small>Show code snippets for copying:</small></p>
          <div class="btn-group">
            <a href="#codemodal" role="button" data-toggle="modal" id="showcode" class="btn btn-primary btn-small">
              <i class="icon-fullscreen icon-white"></i> Show code</a>
            <a href="#codemodal" role="button" data-toggle="modal" id="withcomments" class="btn btn-primary btn-small">
              and output <i class="icon-comment icon-white"></i> </a>
          </div>
        </div>

        <p><small>Search terms or function by name:</small></p>
        <form class="form-search pull-right" action="../../search.html" method="get">
          <div class="input-append">
            <input type="text" class="input-small search-query" name="q" class="span2">
            <button type="submit" class="btn btn-primary">Go</button>
          </div>
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
      </div>
    </div>
  </div>  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseReleaseNotes">
        <strong>Release Notes</strong>
      </a>
    </div>
    <div id="collapseReleaseNotes" class="accordion-body collapse in">
      <div class="accordion-inner">
        <p><small><strong>v1</strong> series come with new and improved sequence, structure, and dynamics analysis
features. See <a href="../../manual/release/index.html">release notes</a> for details.
        </small></p>
      </div>
    </div>
  </div>  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseHowToCite">
        <strong>How to Cite</strong>
      </a>
    </div>
    <div id="collapseHowToCite" class="accordion-body collapse in">
      <div class="accordion-inner">
                      <p>
                <small>
                  <strong>BioNetGen</strong> <br>
                  J. R. Faeder, M. L. Blinov, and W. S. Hlavacek (2009) <a href="http://www.ncbi.nlm.nih.gov/pubmed/19399430/">Rule-based modeling of biochemical systems with BioNetGen</a>, <i>Methods Mol. Biol.</i>, <strong>500</strong>, 113-67. <br> 
                 </small>
              </p>  
              <p>
                <small>
                 <strong>RuleBender</strong> <br>
                  A. M. Smith, W. Xu, Y. Sun, J. R. Faeder and G. E. Marai (2012) <a href="http://bmcbioinformatics.biomedcentral.com:80/articles/10.1186/1471-2105-13-S8-S3">RuleBender: integrated modeling, simulation and visualization for rule-based intracellular biochemistry</a>, <i>BMC Bioinformatics</i>, <strong>13</strong>(suppl. 8), S3 (16 pages). <br>
                </small>
              </p>  
              <p>
                <small>
                  <strong>NFsim</strong> <br>
                  M. W. Sneddon, J. R. Faeder and T. Emonet (2012) <a href="https://www.ncbi.nlm.nih.gov/pubmed/21186362">Efficient modeling, simulation and coarse-graining of biological complexity with NFsim.</a>, <i>Nat. Methods</i>, <strong>8</strong>, 177-183. 
                </small>
              </p>
      </div>
    </div>
  </div>
        </div>
      </div>
    </div>
    <div class="span9 body">
    
  <div class="section" id="simulating-odes">
<h1>Simulating ODEs<a class="headerlink" href="#simulating-odes" title="Permalink to this headline">Â¶</a></h1>
<p>The <code class="docutils literal"><span class="pre">simulate_ode</span></code> command is used to compute a timecourse of the network using
ordinary differential equations to represent the average concentration of each
species.  The initial concentrations for species defined in the Species block
are set to the declared values, while the concentrations of all species
generated by generate_network are set to zero.  simulate_ode calls the program
Network, which provides an interface to the general-purpose ODE-solver CVODE.
Adaptive implicit multi-step methods are used in the propagation to ensure
efficient and accurate solution of the ODE&#8217;s, which are usually stiff for
networks with more than a few species.  For very large systems (more than a
few hundred species), the the sparse=&gt;1 option is recommended.  It uses sparse
matrix methods to avoid storage of the n_species x n_species Jacobian matrix,
which becomes prohibitive for systems with more than about 10^4 species, and
the iterative GMRES algorithm to solve the required systems of linear
equations.  This enables networks with 10^3-10^4+ species to be simulated in a
few minutes (or less) on standard processors.</p>
<p>Note that the parameter sample_times, which sets the times at which the
concentrations are to be sampled, is an example of an array-valued parameter.
Its argument is a comma-separated list of numbers enclosed by square
brackets. The command</p>
<div class="highlight-${1:type}"><div class="highlight"><pre><span></span>simulate_ode({sample_times=&gt;[1,10,100]});
</pre></div>
</div>
<p>would cause the species concentrations and observable values to be printed at
times of 0, 1, 10, and 100.</p>
<p>Parameters for the simulate_ode command:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="62%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Function</th>
<th class="head">Default Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atol</td>
<td>Absolute error tolerance for species concentrations</td>
<td>1e-8</td>
</tr>
<tr class="row-odd"><td>n_steps</td>
<td>Number of intervals at which to report concentrations</td>
<td>1</td>
</tr>
<tr class="row-even"><td>prefix</td>
<td>Base name of CDAT and GDAT files</td>
<td>Base name of
BNGL file</td>
</tr>
<tr class="row-odd"><td>rtol</td>
<td>Relative error tolerance for species concentrations</td>
<td>1e-8</td>
</tr>
<tr class="row-even"><td>sample_times</td>
<td>Times at which concentrations are reported
(supercedes requirment for t_end)</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>sparse</td>
<td>Turns on use of sparse matrix formation of the Jacobian
and iterative solution of linear equations using GMRES.
Recommended for networks with more than few hundred
species.</td>
<td>0 (Off)</td>
</tr>
<tr class="row-even"><td>steady_state</td>
<td>Setting this to non-zero turns on check for
equilibration of species concnetrations. Time course
will stop when steady state is reached. If it is not
reached in the alloted time the simulation will stop
with an error.</td>
<td>0 (Off)</td>
</tr>
<tr class="row-odd"><td>t_start</td>
<td>Starting time for integration</td>
<td>0</td>
</tr>
<tr class="row-even"><td>t_end</td>
<td>End time for integration</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>verbose</td>
<td>Additional output for debugging</td>
<td>0 (Off)</td>
</tr>
</tbody>
</table>
</div>


    </div>
  </div>
</div>
<footer class="footer">
  <div class="row">
    <div class="span12">
      <p><small>
      &copy; Copyright 2010-2017, University of Pittsburgh.
      Last updated on Dec 07, 2017.
      Created using <a href="http://sphinx-doc.org">Sphinx</a> 1.3.5.
      </small></p>
    </div>
  </div>
  </div>
</footer>
<div id="codemodal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã</button>
    <h3 id="myModalLabel">Code Snippets</h3>
  </div>
  <div class="modal-body">
    <textarea id="codesnippets"></textarea>
  </div>
  <div class="modal-footer">
    <button class="btn btn-info" id="selectcode">Select Code</button>
    <!--
    <button class="btn btn-success" id="copycode" data-clipboard-target="codesnippets">Copy Code</button>
    -->
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
  <input type="hidden" id="zeroclipboardpath" value="../../_static/js/zeroclipboard.swf">
</div>
  </body>
</html>