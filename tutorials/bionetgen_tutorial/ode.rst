Simulating ODEs
=========================================================================================================

The ``simulate_ode`` command is used to compute a timecourse of the network using
ordinary differential equations to represent the average concentration of each
species.  The initial concentrations for species defined in the Species block
are set to the declared values, while the concentrations of all species
generated by generate_network are set to zero.  simulate_ode calls the program
Network, which provides an interface to the general-purpose ODE-solver CVODE.
Adaptive implicit multi-step methods are used in the propagation to ensure
efficient and accurate solution of the ODE's, which are usually stiff for
networks with more than a few species.  For very large systems (more than a
few hundred species), the the sparse=>1 option is recommended.  It uses sparse
matrix methods to avoid storage of the n_species x n_species Jacobian matrix,
which becomes prohibitive for systems with more than about 10^4 species, and
the iterative GMRES algorithm to solve the required systems of linear
equations.  This enables networks with 10^3-10^4+ species to be simulated in a
few minutes (or less) on standard processors.

Note that the parameter sample_times, which sets the times at which the
concentrations are to be sampled, is an example of an array-valued parameter.
Its argument is a comma-separated list of numbers enclosed by square
brackets. The command 

.. code-block:: ${1:type}

	simulate_ode({sample_times=>[1,10,100]});

would cause the species concentrations and observable values to be printed at
times of 0, 1, 10, and 100.

Parameters for the simulate_ode command:	

+--------------------+---------------------------------------------------------+---------------+
| Name               | Function                                                | Default Value |
+====================+=========================================================+===============+
| atol               | Absolute error tolerance for species concentrations     | 1e-8          | 
+--------------------+---------------------------------------------------------+---------------+
| n_steps            | Number of intervals at which to report concentrations   | 1             |
+--------------------+---------------------------------------------------------+---------------+
| prefix             | Base name of CDAT and GDAT files                        | Base name of  |
|                    |                                                         | BNGL file     |
+--------------------+---------------------------------------------------------+---------------+
| rtol               | Relative error tolerance for species concentrations     | 1e-8          |
+--------------------+---------------------------------------------------------+---------------+
| sample_times       | Times at which concentrations are reported              | None          |
|                    | (supercedes requirment for t_end)                       |               |
+--------------------+---------------------------------------------------------+---------------+
| sparse             | Turns on use of sparse matrix formation of the Jacobian | 0 (Off)       |
|                    | and iterative solution of linear equations using GMRES. |               |
|                    | Recommended for networks with more than few hundred     |               |
|                    | species.                                                |               |
+--------------------+---------------------------------------------------------+---------------+
| steady_state       | Setting this to non-zero turns on check for             | 0 (Off)       |
|                    | equilibration of species concnetrations. Time course    |               |
|                    | will stop when steady state is reached. If it is not    |               |
|                    | reached in the alloted time the simulation will stop    |               |
|                    | with an error.                                          |               |
+--------------------+---------------------------------------------------------+---------------+
| t_start            | Starting time for integration                           | 0             |
+--------------------+---------------------------------------------------------+---------------+
| t_end              | End time for integration                                | None          |
+--------------------+---------------------------------------------------------+---------------+
| verbose            | Additional output for debugging                         | 0 (Off)       |
+--------------------+---------------------------------------------------------+---------------+
