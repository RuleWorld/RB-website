
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-19801227-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Multiple Sequence Alignment &mdash; RuleBender</title>
    <link rel="stylesheet" href="../../../_static/css/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootswatch-united.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/prodydocs.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../../_static/js/jquery-2.0.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/zeroclipboard.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../../../_static/js/prodydocs.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>

  </head>
  <body data-spy="scroll" data-target="#localtoc" data-offset="190">

<div class="container">
  <div class="row">
    <div class="span12">
      <a href="../../../index.html">
        <img src="../../../_static/logo.png" alt="ProDy logo" id="logo" />
      </a>
    </div>
    <div class="span12">
      <div class="subnav">
        <ul class="nav nav-pills">
        <li class="pull-right">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a>
          </li>
        <li class="pull-right">
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a>
          </li>
        <li class="pull-right">
          <a href="msafile.html" title="MSA File"
             accesskey="N">next</a>
          </li>
        <li class="pull-right">
          <a href="analysis.html" title="Analysis Functions"
             accesskey="P">previous</a>
          </li>
        <li><a href="../../../index.html">Home  &raquo;</a></li>
          <li><a href="../../index.html" >ProDy Manual &raquo;</a></li>
          <li><a href="../index.html" >Reference Manual &raquo;</a></li>
          <li><a href="index.html" accesskey="U">Sequence Analysis &raquo;</a></li> 
        </ul>
      </div>
    </div>
  </div>

  <div class="content">
  <div class="row">
    <div class="span3">
      <div id="sidebar" style="width: 220px">
        <div class="accordion" id="accordion2">
  <div id="searchbox" class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseToolbox">
        <strong>Toolbox</strong>
      </a>
    </div>
    <div id="collapseToolbox" class="accordion-body collapse in">
      <div class="accordion-inner">
        <div id="showcodebuttons" style="margin-bottom: 10px">
          <p><small>Show code snippets for copying:</small></p>
          <div class="btn-group">
            <a href="#codemodal" role="button" data-toggle="modal" id="showcode" class="btn btn-primary btn-small">
              <i class="icon-fullscreen icon-white"></i> Show code</a>
            <a href="#codemodal" role="button" data-toggle="modal" id="withcomments" class="btn btn-primary btn-small">
              and output <i class="icon-comment icon-white"></i> </a>
          </div>
        </div>

        <p><small>Search terms or a module, class or function by name:</small></p>
        <form class="form-search pull-right" action="../../../search.html" method="get">
          <div class="input-append">
            <input type="text" class="input-small search-query" name="q" class="span2">
            <button type="submit" class="btn btn-primary">Go</button>
          </div>
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
      </div>
    </div>
  </div>  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseReleaseNotes">
        <strong>Release Notes</strong>
      </a>
    </div>
    <div id="collapseReleaseNotes" class="accordion-body collapse in">
      <div class="accordion-inner">
        <p><small><strong>v1</strong> series come with new and improved sequence, structure, and dynamics analysis
features. See <a href="../../release/index.html">release notes</a> for details.
        </small></p>
      </div>
    </div>
  </div>  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseHowToCite">
        <strong>How to Cite</strong>
      </a>
    </div>
    <div id="collapseHowToCite" class="accordion-body collapse in">
      <div class="accordion-inner">
        <p><small>
          Bakan A, Meireles LM, Bahar I
          <a class="reference external" href="http://bioinformatics.oxfordjournals.org/content/27/11/1575" target="_blank">
          <i>ProDy</i>: Protein Dynamics Inferred from Theory and Experiments</a> <br/>
          <em>Bioinformatics</em> <strong>2011</strong> 27(11):1575-1577.
        </small></p>
      </div>
    </div>
  </div>
        </div>
      </div>
    </div>
    <div class="span9 body">
    
  <div class="section" id="module-prody.sequence.msa">
<span id="multiple-sequence-alignment"></span><h1>Multiple Sequence Alignment<a class="headerlink" href="#module-prody.sequence.msa" title="Permalink to this headline">¶</a></h1>
<p>This module defines MSA analysis functions.</p>
<dl class="class">
<dt id="prody.sequence.msa.MSA">
<em class="property">class </em><code class="descname">MSA</code><span class="sig-paren">(</span><em>msa</em>, <em>title='Unknown'</em>, <em>labels=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA" title="Permalink to this definition">¶</a></dt>
<dd><p>Store and manipulate multiple sequence alignments.</p>
<p><em>msa</em> must be a 2D Numpy character array. <em>labels</em> is a list of
sequence labels (or titles).  <em>mapping</em> should map label or part of
label to sequence index in <em>msa</em> array. If <em>mapping</em> is not given,
one will be build from <em>labels</em>.</p>
<dl class="method">
<dt id="prody.sequence.msa.MSA.countLabel">
<code class="descname">countLabel</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.countLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.countLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of sequences that <em>label</em> maps onto.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.getArray">
<code class="descname">getArray</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.getArray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.getArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the MSA character array.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.getIndex">
<code class="descname">getIndex</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.getIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.getIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns index of the sequence that <em>label</em> maps onto.  If <em>label</em>
maps onto multiple sequences or <em>label</em> is a list of labels, a list
of indices is returned.  If an index for a label is not found,
return <strong>None</strong>.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.getLabel">
<code class="descname">getLabel</code><span class="sig-paren">(</span><em>index</em>, <em>full=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.getLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.getLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns label of the sequence at given <em>index</em>.  Residue numbers will
be removed from the sequence label, unless <em>full</em> is <strong>True</strong>.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.getResnums">
<code class="descname">getResnums</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.getResnums"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.getResnums" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns starting and ending residue numbers (<a class="reference internal" href="../atomic/fields.html#term-resnum"><span class="xref std std-term">resnum</span></a>) for the
sequence at given <em>index</em>.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.getTitle">
<code class="descname">getTitle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.getTitle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.getTitle" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns title of the instance.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.isAligned">
<code class="descname">isAligned</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.isAligned"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.isAligned" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <strong>True</strong> if MSA is aligned.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.iterLabels">
<code class="descname">iterLabels</code><span class="sig-paren">(</span><em>full=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.iterLabels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.iterLabels" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield sequence labels.  By default the part of the label used for
indexing sequences is yielded.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.numIndexed">
<code class="descname">numIndexed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.numIndexed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.numIndexed" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of sequences that are indexed using the identifier
part or all of their labels.  The return value should be equal to
number of sequences.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.numResidues">
<code class="descname">numResidues</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.numResidues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.numResidues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of residues (or columns in the MSA), if MSA is
aligned.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.numSequences">
<code class="descname">numSequences</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.numSequences"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.numSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of sequences.</p>
</dd></dl>

<dl class="method">
<dt id="prody.sequence.msa.MSA.setTitle">
<code class="descname">setTitle</code><span class="sig-paren">(</span><em>title</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#MSA.setTitle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.MSA.setTitle" title="Permalink to this definition">¶</a></dt>
<dd><p>Set title of the instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="prody.sequence.msa.MSA.split">
<code class="descname">split</code><a class="headerlink" href="#prody.sequence.msa.MSA.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Return split label when iterating or indexing.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="prody.sequence.msa.refineMSA">
<code class="descname">refineMSA</code><span class="sig-paren">(</span><em>msa</em>, <em>label=None</em>, <em>rowocc=None</em>, <em>seqid=None</em>, <em>colocc=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#refineMSA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.refineMSA" title="Permalink to this definition">¶</a></dt>
<dd><p>Refine <em>msa</em> by removing sequences (rows) and residues (columns) that
contain gaps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>msa</strong> (<a class="reference internal" href="#prody.sequence.msa.MSA" title="prody.sequence.msa.MSA"><code class="xref py py-class docutils literal"><span class="pre">MSA</span></code></a>) &#8211; multiple sequence alignment</li>
<li><strong>label</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; remove columns that are gaps in the sequence matching label,
<code class="docutils literal"><span class="pre">msa.getIndex(label)</span></code> must return a sequence index, a PDB identifier
is also acceptable</li>
<li><strong>rowocc</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; row occupancy, sequences with less occupancy will be
removed after <em>label</em> refinement is applied</li>
<li><strong>seqid</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; keep unique sequences at specified sequence identity level,
unique sequences are identified using <a class="reference internal" href="analysis.html#prody.sequence.analysis.uniqueSequences" title="prody.sequence.analysis.uniqueSequences"><code class="xref py py-func docutils literal"><span class="pre">uniqueSequences()</span></code></a></li>
<li><strong>colocc</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; column occupancy, residue positions with less occupancy
will be removed after other refinements are applied</li>
<li><strong>keep</strong> &#8211; keep columns corresponding to residues not resolved in the PDB
structure, default is <strong>False</strong>, applies when <em>label</em> is a PDB
identifier</li>
<li><strong>type</strong> &#8211; bool</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>For Pfam MSA data, <em>label</em> is UniProt entry name for the protein.  You may
also use PDB structure and chain identifiers, e.g. <code class="docutils literal"><span class="pre">'1p38'</span></code> or
<code class="docutils literal"><span class="pre">'1p38A'</span></code>, for <em>label</em> argument and UniProt entry names will be parsed
using <a class="reference internal" href="../proteins/header.html#prody.proteins.header.parsePDBHeader" title="prody.proteins.header.parsePDBHeader"><code class="xref py py-func docutils literal"><span class="pre">parsePDBHeader()</span></code></a> function (see also <a class="reference internal" href="../proteins/header.html#prody.proteins.header.Polymer" title="prody.proteins.header.Polymer"><code class="xref py py-class docutils literal"><span class="pre">Polymer</span></code></a> and
<a class="reference internal" href="../proteins/header.html#prody.proteins.header.DBRef" title="prody.proteins.header.DBRef"><code class="xref py py-class docutils literal"><span class="pre">DBRef</span></code></a>).</p>
<p>The order of refinements are applied in the order of arguments.  If <em>label</em>
and <em>unique</em> is specified is specified, sequence matching <em>label</em> will
be kept in the refined <a class="reference internal" href="#prody.sequence.msa.MSA" title="prody.sequence.msa.MSA"><code class="xref py py-class docutils literal"><span class="pre">MSA</span></code></a> although it may be similar to some
other sequence.</p>
</dd></dl>

<dl class="function">
<dt id="prody.sequence.msa.mergeMSA">
<code class="descname">mergeMSA</code><span class="sig-paren">(</span><em>*msa</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#mergeMSA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.mergeMSA" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an <a class="reference internal" href="#prody.sequence.msa.MSA" title="prody.sequence.msa.MSA"><code class="xref py py-class docutils literal"><span class="pre">MSA</span></code></a> obtained from merging parts of the sequences
of proteins present in multiple <em>msa</em> instances.  Sequences are matched
based on protein identifiers found in the sequence labels.  Order of
sequences in the merged MSA will follow the order of sequences in the
first <em>msa</em> instance.  Note that protein identifiers that map to multiple
sequences will be excluded.</p>
</dd></dl>

<dl class="function">
<dt id="prody.sequence.msa.specMergeMSA">
<code class="descname">specMergeMSA</code><span class="sig-paren">(</span><em>*msa</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/prody/sequence/msa.html#specMergeMSA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prody.sequence.msa.specMergeMSA" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an <a class="reference internal" href="#prody.sequence.msa.MSA" title="prody.sequence.msa.MSA"><code class="xref py py-class docutils literal"><span class="pre">MSA</span></code></a> obtained from merging parts of the sequences
of proteins present in multiple <em>msa</em> instances.  Sequences are matched
based on species section of protein identifiers found in the sequence labels.  
Order of sequences in the merged MSA will follow the order of sequences in the
first <em>msa</em> instance.  Note that protein identifiers that map to multiple
sequences will be excluded.</p>
</dd></dl>

</div>


    </div>
  </div>
</div>
<footer class="footer">
  <div class="row">
    <div class="span12">
      <p><small>
      &copy; Copyright 2010-2017, University of Pittsburgh.
      Last updated on Dec 06, 2017.
      Created using <a href="http://sphinx-doc.org">Sphinx</a> 1.3.5.
      </small></p>
    </div>
  </div>
  </div>
</footer>
<div id="codemodal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Code Snippets</h3>
  </div>
  <div class="modal-body">
    <textarea id="codesnippets"></textarea>
  </div>
  <div class="modal-footer">
    <button class="btn btn-info" id="selectcode">Select Code</button>
    <!--
    <button class="btn btn-success" id="copycode" data-clipboard-target="codesnippets">Copy Code</button>
    -->
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
  <input type="hidden" id="zeroclipboardpath" value="../../../_static/js/zeroclipboard.swf">
</div>
  </body>
</html>